function error(e){var r="Ошибка";$("#message").length&&$("#message").remove(),$("body").append('<div class="modal fade" id="message" tabindex="-1" role="dialog" aria-labelledby="messageLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="messageLabel">'+r+'</h4></div><div class="modal-body">'+e+'</div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">OK</button></div></div></div></div>'),$("#message").modal("show")}function send_form(e,r){e="undefined"==typeof e?"":"send=true&",$.getJSON("/addnew/?"+e+$("form#anketa").serialize()).done(function(e){"undefined"!=typeof e.result&&"OK"==e.result&&("undefined"!=typeof e.id&&$('form#anketa input[name="id"]').val(e.id),"undefined"!=typeof e.redirect&&e.redirect&&"undefined"!=typeof window.obUnloader&&window.obUnloader.resetUnload())})}function validate1(){return!!isWebvisor||($('input[name="amount"]').val()<1e3||$('input[name="amount"]').val()>1e5?(error("Вы не указали сумму."),!1):$('input[name="period"]').val()<5||$('input[name="period"]').val()>30?(error("Вы не указали срок займа."),!1):$('input[name="f"]').val().length<2||!re_name.test($('input[name="f"]').val())?(error("Необходимо указать фамилию."),!1):$('input[name="i"]').val().length<2||!re_name.test($('input[name="i"]').val())?(error("Необходимо указать имя."),!1):$('input[name="o"]').val().length<2||!re_name.test($('input[name="o"]').val())?(error("Необходимо указать отчество."),!1):"0"!=$('input[name="gender"]').val()&&"1"!=$('input[name="gender"]').val()?(error("Вы не указали пол."),!1):16!=$('input[name="phone"]').val().length?(error("Номер телефона указан неверно."),!1):$('input[name="email"]').val().length<7||!re_email.test($('input[name="email"]').val())?(error("Email указан неверно."),!1):!!$("#agree").prop("checked")||(error("Вы не подтвердили своё согласие с условиями сервиса."),!1))}function validate2(){return!!isWebvisor||($('input[name="passport"]').val().length<11?(error("Вы не указали номер и серию паспорта."),!1):$('input[name="passport_who"]').val().length<3?(error("Необходимо указать, кем выдан паспорт."),!1):$('input[name="passport_code"]').val().length<7?(error("Необходимо указать, код подразделения, выдавшего паспорт."),!1):$('input[name="birthplace"]').val().length<3?(error("Необходимо указать место рождения."),!1):$("#region").val().length<2||!re_rc.test($("#region").val())?(error("Необходимо указать регион проживания."),!1):$('input[name="city"]').val().length<2||!re_rc.test($('input[name="city"]').val())?(error("<p>Ошибка в указании населённого пункта места жительства.</p><p>Данное поле может содержать только русские символы, символы пробела, запятую, точку или тире.</p>"),!1):$('input[name="street"]').val().length<2?(error("Необходимо указать улицу места жительства."),!1):$('input[name="building"]').val().length&&re.test($('input[name="building"]').val())?$('input[name="housing"]').val().length&&!re.test($('input[name="housing"]').val())?(error("Ошибочно указан номер строения места жительства. Указывайте только номер дома и литеру, если она есть."),!1):$('input[name="flat"]').val().length&&!re.test($('input[name="flat"]').val())?(error("Ошибочно указан номер квартиры места жительства. Указывайте только номер дома и литеру, если она есть."),!1):"0"==$(".reg_same:checked").val()&&($("#reg_region").val().length<2||!re_rc.test($("#reg_region").val()))?(error("Вы не указали регион регистрации."),!1):"0"==$(".reg_same:checked").val()&&($('input[name="reg_city"]').val().length<2||!re_rc.test($('input[name="reg_city"]').val()))?(error("<p>Ошибка в указании населённого пункта места регистрации.</p><p>Данное поле может содержать только русские символы, символы пробела, запятую, точку или тире.</p>"),!1):"0"==$(".reg_same:checked").val()&&$('input[name="reg_street"]').val().length<2?(error("Необходимо указать улицу регистрации."),!1):"0"!=$(".reg_same:checked").val()||re.test($('input[name="reg_building"]').val())?"0"==$(".reg_same:checked").val()&&$('input[name="reg_housing"]').val().length&&!re.test($('input[name="reg_housing"]').val())?(error("Ошибочно указан номер строения регистрации. Указывайте только номер дома и литеру, если она есть."),!1):!("0"==$(".reg_same:checked").val()&&$('input[name="reg_flat"]').val().length&&!re.test($('input[name="reg_flat"]').val()))||(error("Ошибочно указан номер квартиры регистрации. Указывайте только номер дома и литеру, если она есть."),!1):(error("Ошибочно указан номер дома регистрации. Указывайте только номер дома и литеру, если она есть."),!1):(error("Ошибочно указан номер дома места жительства. Указывайте только номер дома и литеру, если она есть."),!1))}function validate3(){return!!isWebvisor||(re_int.test($('input[name="work_experience"]').val())?re_int.test($('input[name="work_salary"]').val())?$('input[name="work_name"]').val().length<2?(error("Вы не указали название места работы."),!1):$('input[name="work_occupation"]').val().length<2?(error("Вы не указали вашу должность."),!1):"0"==$('input[name="work_region"]').val()?(error("Вы не указали регион работы."),!1):$('input[name="work_city"]').val().length<2?(error("Необходимо указать город работы."),!1):$('input[name="work_street"]').val().length<2?(error("Необходимо указать улицу работы."),!1):!!re.test($('input[name="work_house"]').val())||(error("Ошибочно указан номер дома работы. Указывайте только номер дома и литеру, если она есть."),!1):(error("Вы не указали доход."),!1):(error("Вы не указали стаж работы."),!1))}function validate(){return!!isWebvisor||!!validate1()&&(!!validate2()&&(!!validate3()&&("undefined"!=typeof window.obUnloader&&window.obUnloader.resetUnload(),$("#form-modal").show(),!0)))}var re=/^[а-яА-Я0-9\/]+$/i,re_rc=/^[а-яА-Яё,\W\.\s-]+$/i,re_email=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,re_int=/^\d+$/,re_name=/^[а-яА-Яё,\W\.\s-]+$/i,isWebvisor=new RegExp("^https?://([^/]+metrika.yandex.(ru|ua|com|com.tr|by|kz)|([^/]+.)?webvisor.com)").test(document.referrer);